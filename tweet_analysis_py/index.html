

<!DOCTYPE html>
<html lang="en">
<head>
	<title>Bar Chart Example</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	<script type="text/javascript" src="http://d3js.org/d3.v2.js"></script>
	
	<style>
		.bar.realDonaldTrump { fill: red; }
		.bar.HillaryClinton { fill: blue; }
		.bar.JohnKasich { fill: red; }
		.bar.TedCruz { fill: red; }
		.bar.BernieSanders { fill: blue; }
		.bar{
			color: white;
			stroke: gray;
			stroke-width:1px;
		}
		.label{
			font-size:15px;
			font-weidht:normal;
		}
		.candidatechart{
			background-color: lightgray;
		}
	</style>

</head>
<body>
	<form>
		<select name="Theme">
			<option value="Education">Education</option>
			<option value="Security">Security</option>
			<option value="Immigration">Immigration</option>
			<option value="Hillary">Hillary Clinton</option>
			<option value="Bernie">Bernie Sanders</option>
			<option value="Trump">Donald Trump</option>
			<option value="Cruz">Ted Cruz</option>
			<option value="Kasich">John Kasich</option>
			<option value="Women">Women</option>
			<option value="Healthcare">Healthcare</option>
			<option value="Supreme Court">Supreme Court</option>
			<option value="Tax">Taxes</option>
		</select>
	</form>
	<div id="chart"></div>
	<div id='container'></div>

</body>

	<script type="text/javascript">


	// var twttr = window.twttr = (function(d, s, id) {
	// 	  var js, fjs = d.getElementsByTagName(s)[0],
	// 	    t = window.twttr || {};
	// 	  if (d.getElementById(id)) return t;
	// 	  js = d.createElement(s);
	// 	  js.id = id;
	// 	  js.src = "https://platform.twitter.com/widgets.js";
	// 	  fjs.parentNode.insertBefore(js, fjs);
		 
	// 	  t._e = [];
	// 	  t.ready = function(f) {
	// 	    t._e.push(f);
	// 	  };
		 
	// 	  return t;
	// }(document, "script", "twitter-wjs"));


	// twttr.widgets.createTweet(
	// 	'20',
	// 	document.getElementById('container'),
	// 	{ theme: 'dark'}
	// 	);
// 	{
//   "items": [
//     {
//       "label": "apples",
//       "n": 20
//     },
//     {
//       "label": "oranges",
//       "n": 30
//     },
//     {
//       "label": "bananas",
//       "n": 10
//     },
//     {
//       "label": "plums",
//       "n": 5
//     }
//   ]
// }	
		var theme = "Education";
		function rightTheme(obj){
			return obj.Topic == theme;
		}

		var w = 500,
		    h = 200;

		var svg = d3.select("#chart")
			.append("svg")
			.attr("class",'candidatechart')
			.attr("width", w)
			.attr("height", h);
	
		d3.json("tweetdata.json", function(json) {

			var data = json.Themes.filter(rightTheme);
			var max_n = 50;

			var data = data[0].Data;
			for (var d in data) {
				console.log(d);
				max_n = Math.max(data[d].Tweets, max_n);
				// console.log(data.Data[d]);
			}
			console.log(max_n);
			// debugger;
		
			var dx = w / max_n;
			var dy = h / data.length;
	
			// bars

			var bars = svg.selectAll(".bar")
				.data(data)
				.enter()
				.append("rect")
				.attr("class", function(d, i) {return "bar " + d.Name;})
				.attr("x", function(d, i) {return 0;})
				.attr("y", function(d, i) {return dy*i;})
				.attr("width", function(d, i) {return dx*d.Tweets})
				.attr("height", dy*.9)
				.attr("rx",2)
				.attr("ry",2);
	
			// labels
			var text = svg.selectAll("text")
				.data(data)
				.enter()
				.append("text")
				.attr("class", function(d, i) {return "label " + d.Name;})
				.attr("x", function(d,i) { return dx*d.Tweets})
				.attr("y", function(d, i) {return dy*i + dy/2;})
				.text( function(d) {return '@'+d.Name + " : " + Number(d.Tweets).toFixed(1)  + "%";})
				.style("font-weight", "bold");
		});

		$('select').on('change', function(){
			console.log("Theme changed to: ",this.value);
			theme = this.value;
			d3.json("tweetdata.json",function(json){
				 
				var data = json.Themes.filter(rightTheme);
				var max_n = 50;

				var data = data[0].Data;
				for (var d in data) {
					console.log(d);
					max_n = Math.max(data[d].Tweets, max_n);
					// console.log(data.Data[d]);
				}
				console.log(max_n);
				// debugger;
			
				var dx = w / max_n;
				var dy = h / data.length;

				svg.selectAll(".bar")
					.data(data)
					.transition()
					.attr("width", function(d, i) {return dx*d.Tweets});
				
				svg.selectAll("text")
					.data(data)
					.transition()
					.attr("x", function(d,i) { return dx*d.Tweets})
					.text( function(d) {return '@'+d.Name + " : " + Number(d.Tweets).toFixed(1)  + "%";});
			});
		});
		// {
		// 	svg.selectAll(".bar");
		// }
	</script>
</html>


